【fbx-libra】
# 比較内容について
1 バイナリ = 1 比較項目とし、  
それぞれのバイナリーごとに拡張子を割り振る。  
例)  
.hcw ... Hierarchy Counter Weight  
.vcw ... Vertexes Counter Weight  
.bcw ... Bind pose Counter Weight  
.scw ... Skinning Counter Weight  

#  比較方法
片方を比較したい検証データのバイナリで用意しておき以下の様な感じで実行する  
この例は階層比較、頂点比較、バインドポーズ比較を行うイメージ  

## 直接指定
fbx-libra.exe sample.fbx sample.hcw sample.vcw sample.bcw

## フォルダ指定(未来的には)
fbx-libra.exe sample.fbx sample_tests/..

# CLIの出力イメージ
pytest などの様に最低限各項目の何がダメなのかは欲しい  

``` bash
===========================
sample.hcw ... OK
sample.vcw ... OK
sample.bcw ... NG
===========================
bcwが失敗なんよ
```


# バイナリー化について
色々調べたが、最終的にFlatbuffersが良さそうなので、Flatbuffersでやってみる。  
https://flatbuffers.dev/  
速いのもそうですが.fbsファイルで定義用意して生成するとpythonのdataclassやc++の構造体の自動定義までしてくれるのが地味に便利なやつ。  

## そもそも比較内容をバイナリー化したい理由
以下が理由  
- fbx同士の比較だとテスト時に二つのfbxを全比較しないといけないのがちょっと微妙  
- 特にアニメーション比較とかだとフレームごとのデータにまとまってた方が比較が楽  
  - 個数だめなら速攻でNGだし、構造体比較で効率的に処理できそう。  
  - fbx比較でも構造体に詰め直したら比較できるが、詰め直しが二つのfbxか一つの違いで予め1つ作っておく方が速いはず。  
- fbx同士だと比較する項目を別途何かしらで持つ必要があり、面倒  
  - コマンドライン引数とか設定ファイルとか。  
- 項目を並列で実行したい時、2つのfbxを並列するより一つのcwとfbxの方を比較する方が効率的  

# バイナリーをバラバラに分けるメリット・デメリット
## メリット
- 比較用のバイナリデータを分ける事で個別の関心ごとだけで良い  
- 段階的に開発ができる。  
- フォルダを見た時にどれを比較するかわかりやすい  
- 1つにまとめる場合、やりながら無限に項目増える可能性があり、そのたびに構造の整合性取るの大変なので、バラバラにしておくとその項目のCounterWeight追加追加だけで済む  

- 未来的にfbxと別フォーマット比較する時もその対象をCounterWeight形式で出す部分だけ書けばOK  
  - fbxとfbxだけにしてしまうとfbx ⇔ objや obj ⇔ objなどを書く必要あるが、読み込みと書き出しだけ書けばOK  


## デメリット
- 一括編集が面倒で、それぞれが独自実装になりがち  
- 拡張子がバッティングしてくるとぱっとみ何の比較内容かわかりづらくなるかも  
  - 確か拡張子制限ないはずなので、長くしてみる？  
